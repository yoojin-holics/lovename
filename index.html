<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ì´ë¦„ ê¶í•© í…ŒìŠ¤íŠ¸</title>
  <style>
    body {
      font-family: 'Pretendard', sans-serif;
      background: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      min-height: 100vh;
      padding: 2rem;
    }
    h1 {
      font-size: 2.2rem;
      margin-bottom: 0.5rem;
    }
    .logo {
      width: 120px;
      margin-bottom: 1rem;
    }
    input {
      display: block;
      padding: 0.6rem;
      margin: 0.4rem auto;
      font-size: 1.2rem;
      border: 1px solid #ccc;
      border-radius: 8px;
      width: 240px;
      text-align: center;
    }
    button {
      padding: 0.6rem 1.2rem;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      background-color: #4f46e5;
      color: white;
      cursor: pointer;
      margin-top: 1rem;
    }
    .result {
      margin-top: 2rem;
      text-align: center;
      font-family: monospace;
      font-size: 1.2rem;
    }
    .row {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 0.3rem;
    }
    .row span {
      font-size: 1.6rem;
      width: 1.6rem;
      display: inline-block;
      text-align: center;
    }
    .row .red { color: red; font-weight: bold; }
    .row .blue { color: blue; font-weight: bold; }
    .row .heart { font-size: 1.4rem; }
    .score {
      font-size: 1.6rem;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <img src="gsa.webp" alt="logo" class="logo" />
  <h1>ì´ë¦„ ê¶í•© í…ŒìŠ¤íŠ¸</h1>

  <input type="text" id="name1" placeholder="ì´ë¦„ 1 (2~3ê¸€ì)" />
  <input type="text" id="name2" placeholder="ì´ë¦„ 2 (2~3ê¸€ì)" />
  <button onclick="calculate()">ê¶í•© ë³´ê¸°</button>

  <div class="result" id="result"></div>

  <script>
    const strokeDict = {
      "ã„±": 2, "ã„²": 4, "ã„´": 2, "ã„·": 3, "ã„¸": 6, "ã„¹": 5, "ã…": 4, "ã…‚": 4, "ã…ƒ": 8,
      "ã……": 2, "ã…†": 4, "ã…‡": 1, "ã…ˆ": 3, "ã…‰": 6, "ã…Š": 4, "ã…‹": 3, "ã…Œ": 4, "ã…": 4, "ã…": 3,
      "ã…": 2, "ã…": 3, "ã…‘": 3, "ã…’": 4, "ã…“": 2, "ã…”": 3, "ã…•": 3, "ã…–": 4, "ã…—": 2,
      "ã…˜": 4, "ã…™": 5, "ã…š": 3, "ã…›": 3, "ã…œ": 2, "ã…": 4, "ã…": 5, "ã…Ÿ": 3, "ã… ": 3,
      "ã…¡": 1, "ã…¢": 2, "ã…£": 1,
      "ã„³": 4, "ã„µ": 5, "ã„¶": 5, "ã„º": 7, "ã„»": 9, "ã„¼": 9, "ã„½": 7, "ã„¾": 9, "ã„¿": 9, "ã…€": 8, "ã…„": 6
    };

    function decompose(syllable) {
      const base = 44032;
      const choList = ["ã„±", "ã„²", "ã„´", "ã„·", "ã„¸", "ã„¹", "ã…", "ã…‚", "ã…ƒ", "ã……", "ã…†", "ã…‡", "ã…ˆ", "ã…‰", "ã…Š", "ã…‹", "ã…Œ", "ã…", "ã…"];
      const jungList = ["ã…", "ã…", "ã…‘", "ã…’", "ã…“", "ã…”", "ã…•", "ã…–", "ã…—", "ã…˜", "ã…™", "ã…š", "ã…›", "ã…œ", "ã…", "ã…", "ã…Ÿ", "ã… ", "ã…¡", "ã…¢", "ã…£"];
      const jongList = ["", "ã„±", "ã„²", "ã„³", "ã„´", "ã„µ", "ã„¶", "ã„·", "ã„¹", "ã„º", "ã„»", "ã„¼", "ã„½", "ã„¾", "ã„¿", "ã…€", "ã…", "ã…‚", "ã…„", "ã……", "ã…†", "ã…‡", "ã…ˆ", "ã…Š", "ã…‹", "ã…Œ", "ã…", "ã…"];
      const code = syllable.charCodeAt(0) - base;
      const cho = choList[Math.floor(code / 588)];
      const jung = jungList[Math.floor((code % 588) / 28)];
      const jong = jongList[code % 28];
      return jong ? [cho, jung, jong] : [cho, jung];
    }

    function getStroke(char) {
      const parts = decompose(char);
      return parts.reduce((sum, ch) => sum + (strokeDict[ch] || 0), 0) % 10;
    }

    function sayScore(A1,A2,A3,B1,B2,B3) {
      return (A1+4*B1+6*A2+4*B2+A3)%10*10 + (B1+4*A2+6*B2+4*A3+B3)%10;
    }

    function perfectScore(A1,A2,A3,B1,B2,B3) {
      return (A1+3*A2+3*B1+B2)%10===1 && (3*A2+A3+B1+3*B2)%10===0 && (A2+3*A3+3*B2+B3)%10===0;
    }

    function calculate() {
      const name1 = document.getElementById("name1").value.trim();
      const name2 = document.getElementById("name2").value.trim();
      const result = document.getElementById("result");
      result.innerHTML = "";

      if (![2,3].includes(name1.length) || ![2,3].includes(name2.length)) {
        result.innerHTML = "ì´ë¦„ì€ 2~3ê¸€ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.";
        return;
      }

      const merged = [];
      const nums = [];
      const maxLen = Math.max(name1.length, name2.length, 3); // í•­ìƒ 3ê¸€ì ê¸°ì¤€

      for (let i = 0; i < maxLen; i++) {
        if (i < name1.length) {
          merged.push({char: name1[i], class: 'red'});
          nums.push(getStroke(name1[i]));
        } else {
          merged.push({char: "â¤ï¸", class: "heart"});
          nums.push(0);
        }
        if (i < name2.length) {
          merged.push({char: name2[i], class: 'blue'});
          nums.push(getStroke(name2[i]));
        } else {
          merged.push({char: "ğŸ’™", class: "heart"});
          nums.push(0);
        }
      }

      const rows = [];
      rows.push(`<div class="row">${merged.map(e => `<span class="${e.class}">${e.char}</span>`).join('')}</div>`);
      let temp = nums.slice();
      rows.push(`<div class="row">${temp.map(n => `<span>${n}</span>`).join('')}</div>`);

      while (true) {
        if (temp.length <= 3 && perfectScore(...numsFromName(name1), ...numsFromName(name2))) break;
        if (temp.length <= 2) break;

        const next = [];
        for (let i = 0; i < temp.length - 1; i++) {
          next.push((temp[i] + temp[i+1]) % 10);
        }
        const shift = (temp.length - next.length) * 18;  // ê° ë‹¨ê³„ë§ˆë‹¤ ì¤‘ì•™ ì •ë ¬ì„ ë§ì¶”ê¸° ìœ„í•´ ì™¼ìª½ìœ¼ë¡œ ì¡°ì •
        rows.push(`<div class="row" style="margin-left: ${shift}px">${next.map(n => `<span>${n}</span>`).join('')}</div>`);
        temp = next;
      }

      const score = perfectScore(...numsFromName(name1), ...numsFromName(name2)) ? 100 : sayScore(...numsFromName(name1), ...numsFromName(name2));
      rows.push(`<div class="score">ê¶í•© ì ìˆ˜ëŠ” <b>${score}ì </b>ì…ë‹ˆë‹¤!</div>`);

      result.innerHTML = rows.join("\n");
    }

    function numsFromName(name) {
      const nums = name.split("").map(getStroke);
      return [nums[0], nums[1], nums[2] || 0];
    }
  </script>
</body>
</html>